# Klipper Configurations - Anycubic Vyper
#	 ___      ___  ________  ___  ___  ________
#	|"  \    /"  |/"       )|"  \/"  |/"       )
#	 \   \  //  /(:   \___/  \   \  /(:   \___/
#	  \\  \/. ./  \___  \     \\  \/  \___  \
#	   \.    //    __/  \\    /   /    __/  \\
#	    \\   /    /" \   :)  /   /    /" \   :)
#	     \__/    (_______/  |___/    (_______/
#
# 01010110  01010011  01011001  01010011
#
# Auteur: Virgile de Champigny
#
# Pour compiler le firmware de la carte mère, exécuter les commandes suivantes depuis le terminal SSH :
#
# > cd /home/pi/klipper/
# > make clean
# > make menuconfig
#
# Micro-controller: STM32
# Processor model: STM32F103
# Disable SWD at startup: enabled
# Bootloader offset: 32KiB
# Communication interface: Serial (on USART1 PA10/PA9)
#
# Compiler le firmware de la carte mère avec la commande :
#
# > make
#
# Copier sur une carte SD le fichier généré dans "out/klipper.bin" et renommer le en "main_board_20xxxxxx.bin"
# Insérer la carte SD dans l'imprimante et démmarrer celle ci, puis patientez quelques secondes.
#
# NB: Après la flash, l'écran d'origine de la Vyper devient inactif.
#
# Nettoyage des fichiers générés avec la commande :
#
# > make clean
#
####################################################################
# FICHIERS A INCLURE
####################################################################

[include macros/*.cfg]
#[include adxl345.cfg]

####################################################################
# CARTE MERE - MCU
####################################################################

[mcu]
#    lancer la commande > ls /dev/serial/by-id/* depuis le terminal SSH pour obtenir votre serial.
serial: /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
#    Le port série à connecter à l'unité MCU. Si vous n'êtes pas sûr (ou s'il
#    change) consultez la section "Où est mon port série ?" de la FAQ.
#    Ce paramètre doit être fourni lors de l'utilisation d'un port série.
#baud: 250000
#    Le débit en bauds à utiliser. La valeur par défaut est 250000.
restart_method: command
#    Ceci contrôle le mécanisme que l'hôte utilisera pour réinitialiser le microcontrôleur.
#    Les choix sont 'arduino', 'cheetah', 'rpi_usb', et 'command'. La méthode 'arduino'
#    (basculer DTR) est courante sur les cartes et clones Arduino.
#    La méthode 'cheetah' est une méthode particulière nécessaire pour certaines cartes
#    Fysetc Cheetah. La méthode 'rpi_usb' est utile sur les cartes Raspberry Pi avec des
#    micro-contrôleurs alimentés par USB - elle désactive brièvement l'alimentation de tous
#    les ports USB pour effectuer une réinitialisation du microcontrôleur.
#    La méthode 'command' implique l'envoi d'une commande Klipper au microcontrôleur
#    afin qu'il puisse # se réinitialiser.
#    La valeur par défaut est 'arduino' si le micro-contrôleur communique via un port série,
#    'command' sinon.

####################################################################
# LIMITE DE LA MACHINE
####################################################################

[safe_z_home]
home_xy_position: -3,-7
#    Une coordonnée X, Y (par exemple 100, 100) où la mise à l'origine Z
#    doit être effectuée. Ce paramètre doit être fourni.
#speed: 50.0
#    Vitesse à laquelle la tête de l'outil est déplacée vers la position de
#    référence Z sûre. La valeur par défaut est 50 mm/s
z_hop: 10
#    Distance (en mm) pour lever l'axe Z avant le retour au point d'origine.
#    Cette valeur est appliquée à toute commande d'initialisation, même
#    si elle n'initialise pas l'axe Z. Si l'axe Z est déjà ramené à la position
#    de base et que la position Z actuelle est inférieure à z_hop, alors ceci
#    lèvera la tête à une hauteur de z_hop. Si l'axe Z n'est pas déjà centré,
#    la tête est relevée de z_hop.
#    La valeur par défaut est de ne pas implémenter le relevage en Z.
#z_hop_speed: 15.0
#    Vitesse (en mm/s) à laquelle l'axe Z est relevé avant le retour à la
#    position initiale. La valeur par défaut est de 15 mm/s.
#move_to_previous: False
#    Lorsqu'il a la valeur True, les axes X et Y sont réinitialisés à leurs
#    positions précédentes après retour à la position initiale de l'axe Z.
#    La valeur par défaut est False.

#-----------------------------------------------------------------#

[printer]
kinematics: cartesian
#    Le type d'imprimante utilisée. Cette option peut être l'une des suivantes : cartésienne,
#    corexy, corexz, hybrid_corexy, hybrid_corexz, rotary_delta, delta, deltesian, polar, winch,
#    ou none. Ce paramètre doit être spécifié.
max_velocity: 300
#    Vitesse maximale (en mm/s) de la tête d'outil (par rapport à l'impression). Ce paramètre doit être spécifié.
max_accel: 2400
#    Accélération maximale (en mm/s^2) de la tête de l'outil (par rapport à l'impression).
#    Ce paramètre doit être spécifié.
#max_accel_to_decel: 1200
#    Une pseudo-accélération (en mm/s^2) contrôlant la vitesse à laquelle la tête de l'outil peut
#    passer de l'accélération à la décélération. Elle est utilisée pour réduire la vitesse maximale
#    des courts mouvements en zigzag (et donc réduire les vibrations de l'imprimante dues à ces
#    mouvements). La valeur par défaut est la moitié de max_accel.
square_corner_velocity: 5
#    La vitesse maximale (en mm/s) à laquelle la tête d'outil peut parcourir un angle de 90 degrés.
#    Une valeur non nulle peut réduire les changements dans les débits de l'extrudeuse en
#    permettant des changements de vitesse instantanés de la tête d'outil pendant les virages.
#    Cette valeur configure l'algorithme interne de prise de virage à vitesse centripète ; les virages
#    dont l'angle est supérieur à 90 degrés auront une vitesse de prise de virage plus élevée tandis
#    que ceux d'angles inférieurs à 90 degrés auront une vitesse de virage plus faible.
#    Si ce paramètre est défini sur zéro, la tête d'outil décélérera jusqu'à zéro à chaque coin.
#    La valeur par défaut est 5mm/s.
max_z_velocity: 60
#    Ceci définit la vitesse maximale (en mm/s) du mouvement le long de l'axe z
#    Ce paramètre peut être utilisé pour limiter la vitesse maximale du moteur pas à pas z.
#    La valeur par défaut est l'utilisation de max_velocity pour max_z_velocity.
max_z_accel: 100
#    Ce paramètre définit l'accélération maximale (en mm/s^2) du mouvement sur l'axe z.
#    Cela limite l'accélération du moteur pas à pas z. La valeur par défaut est
#    d'utiliser max_accel pour max_z_accel.

####################################################################
# DÉLAI D'INACTIVITÉ
####################################################################

[idle_timeout]
#gcode:
#    Une liste de commandes G-Code à exécuter lors d'un délai d'inactivité. Voir
#    docs/Command_Templates.md pour le format G-Code. La valeur par défaut
#    est d'exécuter "TURN_OFF_HEATERS" et "M84".
timeout: 1800
#    Durée d'attente (en secondes) avant d'exécuter les commandes G-Code ci-dessus.
#    La valeur par défaut est de 600 secondes.

####################################################################
# STEEPER
####################################################################

[stepper_x]
step_pin: PC2
#    Broche GPIO du moteur (déclenchée à l'état haut). Ce paramètre doit être fourni.
dir_pin: PB9
#    Broche GPIO de direction (le niveau haut indique une direction positive). Ce paramètre doit être fourni.
enable_pin: !PC3
#    Broche d'activation (par défaut, enable est haut ; utilisez ! pour indiquer enable
#    bas). Si ce paramètre n'est pas fourni, le pilote du moteur pas à pas doit toujours être activé.
microsteps: 16
#    Le nombre de micropas utilisés par le pilote du moteur pas à pas. Ce paramètre doit être fourni.
rotation_distance: 40
#    Distance (en mm) parcourue par l'axe lors d'une rotation complète du moteur pas à pas
#    (ou de l'engrenage final si le rapport de vitesse est spécifié). Ce paramètre doit être fourni.
full_steps_per_rotation: 200
#    Nombre de pas complets pour une rotation complète du moteur pas à pas.
#    Réglez ce paramètre sur 200 pour un moteur pas à pas de 1,8 degré ou sur 400 pour
#    un moteur de 0,9 degré. La valeur par défaut est 200.
endstop_pin: !PA7
#    Broche de détection de l'interrupteur de fin de course. Si cette broche est sur un mcu différent de
#    celui du moteur pas à pas, cela active le "multi-mcu". Ce paramètre doit être fourni pour les moteurs
#    pas à pas X, Y, et Z sur les imprimantes de style cartésien.
position_endstop: -3
#    Emplacement de la butée (en mm). Ce paramètre doit être fourni pour les moteurs X, Y et Z
#    des imprimantes de style cartésien.
position_min: -3
#    Distance minimale valide (en mm) vers laquelle l'utilisateur peut commander le moteur pas à pas.
#    La valeur par défaut est 0mm.
position_max: 245
#    Distance maximale valide (en mm) vers laquelle l'utilisateur peut ordonner au moteur de se déplacer.
#    Ce paramètre doit être fourni pour les moteurs X, Y, et Z des imprimantes de type cartésien.
homing_speed: 30.0
#    Vitesse maximale (en mm/s) du moteur pas à pas lors de la mise à l'origine.
#    La valeur par défaut est de 5mm/s.

#-----------------------------------------------------------------#

[stepper_y]
step_pin: PB8
dir_pin: PB7
enable_pin: !PC13
microsteps: 16
rotation_distance: 32
full_steps_per_rotation: 200
endstop_pin: !PC5
position_endstop: -10
position_min: -10
position_max: 250
homing_speed: 30.0

#-----------------------------------------------------------------#

[stepper_z]
step_pin: PB6
dir_pin: !PB5
enable_pin: !PC14
microsteps: 16
rotation_distance: 8
full_steps_per_rotation: 200
endstop_pin: PB2
position_endstop: 0.0
position_min: -3
position_max: 260
homing_speed: 5.0

#-----------------------------------------------------------------#

[stepper_z1]
step_pin: PC0
dir_pin: !PC1
enable_pin: !PC15
microsteps: 16
rotation_distance: 8
full_steps_per_rotation: 200
endstop_pin: PC6

####################################################################
# CONFIGURATION EXTRUDEUR
#-------------------------------------------------------------------
# SI VOUS SUPPRIMER LA CONFIGURATION GÉNÉRÉE AUTOMATIQUEMENT (EN BAS DE PAGE)
# DÉCOMMENTER -> CONTROL, PID_KP, PID_KI, PID_KD.
####################################################################

[extruder]
step_pin: PB4
#    Broche GPIO du moteur (déclenchée à l'état haut). Ce paramètre doit être fourni.
dir_pin: !PB3
#    Broche GPIO de direction (le niveau haut indique une direction positive). Ce paramètre doit être fourni
enable_pin: !PA15
#    Broche d'activation (par défaut, enable est haut ; utilisez ! pour indiquer enable
#    bas). Si ce paramètre n'est pas fourni, le pilote du moteur pas à pas doit toujours être activé.
microsteps: 16
#    Le nombre de micropas utilisés par le pilote du moteur pas à pas. Ce paramètre doit être fourni.
rotation_distance: 22.248
#    rotation_distance = <previous_rotation_distance> * <actual_extrude_distance> / <requested_extrude_distance>
#    pour commencer, mesurer le diametre de la roue de l'extrudeur : mesure x 3.14 = rotation distance.
#    Distance (en mm) parcourue par l'axe lors d'une rotation complète du moteur pas à pas
#    (ou de l'engrenage final si le rapport de vitesse est spécifié). Ce paramètre doit être fourni.
full_steps_per_rotation: 200
#    Nombre de pas complets pour une rotation complète du moteur pas à pas.
#    Réglez ce paramètre sur 200 pour un moteur pas à pas de 1,8 degré ou sur 400 pour
#    un moteur de 0,9 degré. La valeur par défaut est 200.
gear_ratio: 50:17
#    Le rapport d'engrenage si le moteur pas à pas est relié à l'axe via une démultiplication.
#    Par exemple, on peut spécifier "5:1" si un réducteur de 5 pour 1 est utilisé.
#    Si l'axe a plusieurs démultiplications, on peut spécifier une liste de rapports séparés par
#    des virgules (par exemple, "57:11, 2:1"). Si un rapport de vitesse est spécifié, alors
#    rotation_distance spécifie la distance parcourue par l'axe pour une rotation complète
#    de l'engrenage final. La valeur par défaut est de ne pas utiliser de rapport de vitesse.
nozzle_diameter: 0.400
#    Diamètre de l'orifice de la buse (en mm). Ce paramètre doit être fourni.
filament_diameter: 1.750
#    Diamètre moyen du filament (en mm) lorsqu'il entre dans l'extrudeuse. Ce paramètre doit être fourni.
heater_pin: PA1
#    Broche de sortie PWM contrôlant le chauffage. Ce paramètre doit être fourni.
sensor_type: ATC Semitec 104GT-2
#    Type de capteur - les thermistances courantes sont "EPCOS 100K B57560G104F",
#    "ATC Semitec 104GT-2", "ATC Semitec 104NT-4-R025H42G", "Generic
#    3950", "Honeywell 100K 135-104LAG-J01", "NTC 100K MGB18-104F39050L32",
#    "SliceEngineering 450", et "TDK NTCG104LH104JT1". Voir la section "Capteurs de
#    température" pour d'autres capteurs. Ce paramètre doit être fourni.
sensor_pin: PC4
#    Broche d'entrée analogique connectée au capteur. Ce paramètre doit être fourni.
#control: pid
#    Algorithme de contrôle (soit pid, soit watermark). Ce paramètre doit être fourni.
#pid_kp: 31.799
#pid_ki: 2.255
#pid_kd: 112.092
#    Les paramètres proportionnels (pid_Kp), intégraux (pid_Ki), et dérivés (pid_Ki)
#    du système de contrôle par rétroaction PID. Klipper évalue les paramètres PID
#    avec la formule générale suivante :
#        fan_pwm = max_power - (Kp*e + Ki*integral(e) - Kd*derivative(e)) / 255
#    Où "e" est "température_cible - température_mesurée" et
#    "fan_pwm" est le débit du ventilateur demandé, 0,0 correspondant à un arrêt complet
#    et 1,0 correspond à un fonctionnement à plein régime. Les paramètres pid_Kp, pid_Ki,
#    et pid_Kd doivent être fournis lorsque l'algorithme de contrôle PID est activé.
min_temp: 0
max_temp: 260
#    La plage maximale de températures valides (Celsius) dans laquelle l'élément de
#    chauffe doit rester. Ceci contrôle une fonction de sécurité implémentée dans le code
#    du micro-contrôleur - si la température mesurée sort de cette plage, le microcontrôleur
#    se met en état d'arrêt. Ce contrôle peut aider à détecter certaines défaillances matérielles
#    de l'élément chauffant et/ou du capteur. Définissez cette plage suffisamment large pour
#    que des températures raisonnables n'entraînent pas d'erreur. Ces paramètres doivent être fournis.
min_extrude_temp: 180
#   La température minimale (Celsius) au-dessus de laquelle les commandes de
#   déplacement de l'extrudeuse peuvent être émises. La valeur par défaut est 170° C.
pressure_advance: 0
#    La quantité de filament à pousser dans l'extrudeuse durant l'accélération de celle-ci.
#    Une quantité égale de filament est rétractée durant la décélération. Elle est mesurée
#    en millimètre/seconde. La valeur par défaut est 0, ce qui désactive la fonctionnalité
#    d'avance de pression.
pressure_advance_smooth_time: 0.040
#    Une durée (en secondes) à utiliser lors du calcul de la vitesse moyenne de l'extrudeuse
#    pour l'avance de pression. Une valeur plus grande donne lieu à des mouvements
#    d'extrusion plus lisses. Ce paramètre ne doit pas dépasser 200ms.
#    Ce paramètre ne s'applique que si pressure_advance est différent de zéro. La valeur
#    par défaut est 0.040 (40 millisecondes).
max_extrude_only_distance: 500.0
#    Longueur maximale (en mm de filament) qu'un mouvement de rétraction ou d'extrusion
#    peut fournir. Si un mouvement de rétraction ou d'extrusion unique demande une
#    distance supérieure à cette valeur, une erreur sera renvoyée.
#    La valeur par défaut est 50mm.
instantaneous_corner_velocity: 15
#    La variation instantanée maximale de la vitesse (en mm/s) de l'extrudeuse
#    pendant la jonction de deux mouvements. La valeur par défaut est 1mm/s.
max_extrude_only_accel: 2000
#    Vitesse maximale (en mm/s) et accélération (en mm/s^2) du moteur de l'extrudeuse
#    pour les rétractions et les mouvements d'extrusion seuls. Ces paramètres n'ont aucun
#    impact sur les mouvements d'impression normaux. S'ils ne sont pas spécifiés, ils sont
#    calculés pour correspondre à la limite d'un mouvement qu'une impression de
#    section transversale de 4.0*diamètre_buse^2 aurait.
max_extrude_cross_section: 50
#    Surface maximale (en mm^2) d'une section transversale d'extrusion (ex:
#    largeur de l'extrusion multipliée par la hauteur de la couche). Ce paramètre
#    permet d'éviter d'extruder des quantités excessives durant de petits déplacements
#    XY. Si un déplacement demande une quantité d'extrusion supérieure à cette valeur,
#    une erreur sera renvoyée. La valeur par défaut est 4.0 *diamètre_buse^2

####################################################################
# CONFIGURATION PLATEAU CHAUFFANT
#-------------------------------------------------------------------
# SI VOUS SUPPRIMER LA CONFIGURATION GÉNÉRÉE AUTOMATIQUEMENT (EN BAS DE PAGE)
# DÉCOMMENTER -> CONTROL, PID_KP, PID_KI, PID_KD.
####################################################################

[heater_bed]
heater_pin: PA4
#    Broche de sortie PWM contrôlant le chauffage. Ce paramètre doit être fourni.
sensor_type: EPCOS 100K B57560G104F
#    Type de capteur - les thermistances courantes sont "EPCOS 100K B57560G104F",
#    "ATC Semitec 104GT-2", "ATC Semitec 104NT-4-R025H42G", "Generic
#    3950", "Honeywell 100K 135-104LAG-J01", "NTC 100K MGB18-104F39050L32",
#    "SliceEngineering 450", et "TDK NTCG104LH104JT1". Voir la section "Capteurs de
#    température" pour d'autres capteurs. Ce paramètre doit être fourni.
sensor_pin: PB0
#    Broche d'entrée analogique connectée au capteur. Ce paramètre doit être fourni.
min_temp: -5
max_temp: 110
#    La plage maximale de températures valides (Celsius) dans laquelle l'élément de
#    chauffe doit rester. Ceci contrôle une fonction de sécurité implémentée dans le code
#    du micro-contrôleur - si la température mesurée sort de cette plage, le microcontrôleur
#    se met en état d'arrêt. Ce contrôle peut aider à détecter certaines défaillances matérielles
#    de l'élément chauffant et/ou du capteur. Définissez cette plage suffisamment large pour
#    que des températures raisonnables n'entraînent pas d'erreur. Ces paramètres doivent être fournis.
#control: pid
#   Algorithme de contrôle (soit pid, soit watermark). Ce paramètre doit être fourni.
#pid_kp: 64.650
#pid_ki: 0.662
#pid_kd: 1578.277
#    Les paramètres proportionnels (pid_Kp), intégraux (pid_Ki) et dérivés (pid_Kd)
#    du système de contrôle de rétroaction PID. Klipper évalue les paramètres PID avec
#    la formule générale suivante :
#       heater_pwm = (Kp*erreur + Ki*intégrale(erreur) - Kd*dérivée(erreur)) / 255
#    Où "erreur" est le résultat de "requested_temperature - measured_temperature" et
#    "heater_pwm" est le taux de chauffage demandé, 0.0 étant complètement éteint et
#    1.0 étant complètement allumé. Pensez à utiliser la commande PID_CALIBRATE pour
#    obtenir ces paramètres.  Les paramètres pid_Kp, pid_Ki, et pid_Kd doivent être
#    fournis pour l'algorithme PID.

####################################################################
# REFROIDISSEMENT
####################################################################

[heater_fan extruder_fan]
pin: PB1
#   Broche de sortie contrôlant le ventilateur. Ce paramètre doit être fourni.
max_power: 1.0
#    La puissance maximale (exprimée en tant que valeur comprise entre 0,0 et 1,0) à laquelle
#    régler la broche. La valeur 1.0 permet de régler la broche entièrement activée pendant de
#    longues périodes, tandis qu'une valeur de 0,5 permet à la broche de n'être activée que
#    durant la moitié du temps au maximum. Ce paramètre peut être utilisé pour limiter la
#    puissance totale de sortie (sur des périodes prolongées) du ventilateur.
#    Si cette valeur est inférieure à 1,0, les demandes de vitesse du ventilateur seront mises à
#    l'échelle entre zéro et max_power (par exemple, si la puissance maximale est de 0,9 et
#    qu'une vitesse de 80 % est demandée, la puissance du ventilateur sera réglée à 72 %.
#    La valeur par défaut est 1.0.
heater: extruder
#    Nom de la section de configuration définissant le chauffage auquel ce ventilateur est associé.
#    Si une liste de noms d'éléments chauffants séparés par des virgules est fournie ici, le
#    ventilateur sera activé lorsque l'un des chauffages donnés est activé.
#    La valeur par défaut est "extruder".
heater_temp: 40.0
#    Température (en Celsius) en dessous de laquelle l'élément chauffant doit descendre pour que
#    le ventilateur soit désactivé. La valeur par défaut est 50 °C.
fan_speed: 1.0
#    La vitesse du ventilateur (exprimée sous la forme d'une valeur comprise entre 0,0 et 1,0) à
#    laquelle le ventilateur sera réglé lorsque l'élément chauffant qui lui est associé est activé.
#    La valeur par défaut est 1.0
#cycle_time: 0.010
#    La durée (en secondes) de chaque cycle d'alimentation PWM du ventilateur. Il est
#    recommandé que cette durée soit de 10 millisecondes ou plus si vous utilisez un PWM logiciel.
#    La valeur par défaut est de 0,010 seconde.
kick_start_time: 0.0
#    Durée (en secondes) de fonctionnement du ventilateur à pleine vitesse, soit lors de sa première
#    activation soit lors d'une augmentation de plus de 50% (pour faire tourner le ventilateur).
#    La valeur par défaut est de 0,100 seconde.

#-----------------------------------------------------------------#

[fan]
pin: PA0
#   Broche de sortie contrôlant le ventilateur. Ce paramètre doit être fourni.
max_power: 1.0
#    La puissance maximale (exprimée en tant que valeur comprise entre 0,0 et 1,0) à laquelle
#    régler la broche. La valeur 1.0 permet de régler la broche entièrement activée pendant de
#    longues périodes, tandis qu'une valeur de 0,5 permet à la broche de n'être activée que
#    durant la moitié du temps au maximum. Ce paramètre peut être utilisé pour limiter la
#    puissance totale de sortie (sur des périodes prolongées) du ventilateur.
#    Si cette valeur est inférieure à 1,0, les demandes de vitesse du ventilateur seront mises à
#    l'échelle entre zéro et max_power (par exemple, si la puissance maximale est de 0,9 et
#    qu'une vitesse de 80 % est demandée, la puissance du ventilateur sera réglée à 72 %.
#    La valeur par défaut est 1.0.
#cycle_time:
#    La durée (en secondes) de chaque cycle d'alimentation PWM du ventilateur. Il est
#    recommandé que cette durée soit de 10 millisecondes ou plus si vous utilisez un PWM logiciel.
#    La valeur par défaut est de 0,010 seconde.
kick_start_time: 0.0
#    Durée (en secondes) de fonctionnement du ventilateur à pleine vitesse, soit lors de sa première
#    activation soit lors d'une augmentation de plus de 50% (pour faire tourner le ventilateur).
#    La valeur par défaut est de 0,100 seconde.

#-----------------------------------------------------------------#

[controller_fan Mainboard]
pin: PA14
#   Broche de sortie contrôlant le ventilateur. Ce paramètre doit être fourni.
max_power: 1.0
#    La puissance maximale (exprimée en tant que valeur comprise entre 0,0 et 1,0) à laquelle
#    régler la broche. La valeur 1.0 permet de régler la broche entièrement activée pendant de
#    longues périodes, tandis qu'une valeur de 0,5 permet à la broche de n'être activée que
#    durant la moitié du temps au maximum. Ce paramètre peut être utilisé pour limiter la
#    puissance totale de sortie (sur des périodes prolongées) du ventilateur.
#    Si cette valeur est inférieure à 1,0, les demandes de vitesse du ventilateur seront mises à
#    l'échelle entre zéro et max_power (par exemple, si la puissance maximale est de 0,9 et
#    qu'une vitesse de 80 % est demandée, la puissance du ventilateur sera réglée à 72 %.
#    La valeur par défaut est 1.0.
fan_speed: 1.0
#    Vitesse du ventilateur (exprimée comme une valeur de 0,0 à 1,0) à laquelle celui-ci
#    sera réglé lorsqu'un chauffage ou un pilote pas à pas est actif.
#    La valeur par défaut est 1.0
idle_timeout: 60
#    Durée (en secondes) après activité d'un pilote pas à pas ou d'un élément chauffant
#    pour laquelle le ventilateur doit continuer de fonctionner. La valeur par défaut
#    est de 30 secondes.
heater: extruder, heater_bed
stepper: stepper_x, stepper_y, stepper_z, extruder
#    Nom de la section de configuration définissant l'élément chauffant/pilote auquel ce ventilateur
#    est associé. Si une liste séparée par des virgules de noms d'éléments chauffants/pilotes est
#    fournie ici, le ventilateur s'activera lorsque l'un des éléments chauffants/pilotes donnés est activé.
#    Le chauffage par défaut est "extruder", le pilote par défaut est tous.

####################################################################
# BED MESH - PROBE - PROBE RESET PIN - PROBE RESET
####################################################################

[bed_mesh]
speed: 50
#    La vitesse (en mm/s) des déplacements entre les points de palpage
#    durant l'étalonnage. La valeur par défaut est 50.
horizontal_move_z: 1.0
#    La hauteur (en mm) à laquelle la tête doit être relevée juste avant de
#    lancer une opération de palpage. La valeur par défaut est 5.
mesh_min: 10, 10
#    Définit les coordonnées X, Y minimales du maillage pour les lits
#    rectangulaires. Ces coordonnées sont relatives à l'emplacement de la
#    sonde. Cette position sera le premier point sondé, le plus proche de
#    l'origine. Ce paramètre doit être fourni pour des lits rectangulaires.
mesh_max: 235, 235
#    Définit les coordonnées X, Y maximales du maillage pour les lits
#    rectangulaires. Le principe est le même que pour mesh_min, mais ce
#    sera le point le plus éloigné atteignable par rapport à l'origine du lit.
#    Ce paramètre  doit être fourni pour des lits rectangulaires.
probe_count: 9, 9
#    Pour les lits rectangulaires, il s'agit d'une paire d'entiers X, Y séparés par
#    des virgules, définissant le nombre de points à palper le long de chaque
#    axe. Une valeur seule est également valide, auquel cas cette valeur sera
#    appliquée aux deux axes. La valeur par défaut est 3, 3.
#move_check_distance: 5.0
#    La distance (en mm) le long d'un mouvement pour vérifier le split_delta_z.
#    C'est également la longueur minimale pour laquelle un mouvement peut
#    être divisé. La valeur par défaut est 5.0.
mesh_pps: 2, 2
#    Une paire de nombres entiers X, Y séparés par des virgules, définissant le
#    nombre de points par segment à interpoler dans le maillage le long de
#    chaque axe. Un "segment" étant défini comme l'espace entre chaque point
#    palpé. L'utilisateur peut saisir une seule valeur s'appliquant alors aux
#    deux axes. La valeur par défaut est 2, 2.
algorithm: bicubic
#    L'algorithme d'interpolation à utiliser. Soit "lagrange", soit "bicubic".
#    Cette option n'affecte pas les grilles 3x3 forcées d'utiliser l'échantillonnage
#    de lagrange. La valeur par défaut est lagrange.
#bicubic_tension: .2
#    Lors de l'utilisation de l'algorithme bicubic, le paramètre de tension ci-
#    dessus peut être appliqué pour modifier la quantité de pente interpolée.
#    Des nombres plus grands augmenteront la quantité de pente entraînant
#    une plus grande courbure du maillage. La valeur par défaut est 0,2.
fade_start: 1.0
#    La position z du gcode à partir de laquelle il faut commencer à éliminer
#    progressivement l'ajustement z lorsque la compensation est activée.
#    La valeur par défaut est 1.0.
fade_end: 10.0
#    La position z du gcode à partir de laquelle la compensation se termine.
#    Lorsqu'elle est définie à une valeur inférieure à fade_start, la compensation
#    est désactivée. Notez que la compensation peut ajouter une mise à l'échelle
#    indésirable le long de l'axe z d'une impression. Si un utilisateur souhaite
#    activer la compensation, une valeur de 10.0 est recommandée.
#    La valeur par défaut est 0.0, ce qui désactive la compensation.

####################################################################
# SI VOUS SUPPRIMER LA CONFIGURATION GÉNÉRÉE AUTOMATIQUEMENT (EN BAS DE PAGE)
# DÉCOMMENTER -> Z_OFFSET.
####################################################################

[probe]
pin: !PB12
#    Broche de détection de la sonde. Si la broche se trouve sur un microcontrôleur différent
#    de celui des moteurs de l'axe Z alors elle active le "multi-mcu homing". Ce paramètre
#    doit être fourni.
#deactivate_on_each_sample: True
#    Ceci détermine si Klipper doit exécuter le gcode de désactivation entre chaque tentative
#    de palpage lors d'une séquence de palpages multiples.
#    La valeur par défaut est True.
#x_offset: 0.0
#    La distance (en mm) entre la sonde et la buse le long de l'axe x.
#    La valeur par défaut est 0.
#y_offset: 0.0
#    La distance (en mm) entre la sonde et la buse le long de l'axe y.
#    La valeur par défaut est 0.
#z_offset: 0.0
#    La distance (en mm) entre le lit et la buse lorsque la sonde se déclenche.
#    Ce paramètre doit être fourni.
speed: 1.0
#    Vitesse (en mm/s) de l'axe Z lors du palpage. La valeur par défaut est 5mm/s.
samples: 2
#    Le nombre de fois où il faut palper chaque point. Les valeurs z palpées seront
#    moyennées. La valeur par défaut est de palper 1 fois.
#sample_retract_dist: 2.0
#    Distance (en mm) à parcourir pour relever la tête de l'outil entre chaque palpage
#    (en cas d'échantillonnage multiple). La valeur par défaut est 2mm.
lift_speed: 5
#    Vitesse (en mm/s) de l'axe Z lors du levage de la sonde entre les échantillons.
#    La valeur par défaut est la même que celle du paramètre 'speed'.
samples_result: average
#    La méthode de calcul lorsque l'on échantillonne plusieurs fois - soit "médiane"
#    (median) ou "moyenne" (average). La valeur par défaut est "moyenne".
samples_tolerance: 0.100
#    La distance Z maximale (en mm) à laquelle un échantillon peut différer des autres
#    échantillons. Si cette tolérance est dépassée, soit une erreur est signalée soit une
#    tentative de palpage est recommencée (cf. samples_tolerance_retries).
#    La valeur par défaut est 0.100mm.
samples_tolerance_retries: 2
#    Le nombre de fois qu'il faut réessayer quand un palpage dépasse la tolérance des
#    échantillons. Lors d'une nouvelle tentative, tous les échantillons en cours sont rejetés
#    et une tentative de palpa est relancée. Si un ensemble valide d'échantillons n'est pas
#    obtenu dans le nombre de tentatives donné, une erreur est signalée. La valeur par défaut
#    est zéro, ce qui entraîne le signalement d'une erreur dès le premier échantillon dépassant
#    la tolérance de samples_tolerance.
activate_gcode:
    probe_reset
#    Une liste de commandes G-Code à exécuter avant chaque tentative de palpage.
#    Voir docs/Command_Templates.md pour le format G-Code. Cela peut être  utile si la sonde
#    doit être activée d'une manière particulière. Ne pas envoyer ici de commandes déplaçant
#    la tête de l'outil (par exemple, G1). La valeur par défaut est de ne pas exécuter de commandes
#    G-code spéciales lors de l'activation.
#deactivate_gcode:
#    Une liste de commandes G-Code à exécuter après la fin de chaque tentative de palpage
#    terminée. Voir docs/Command_Templates.md pour le format G-Code. Ne pas envoyer ici
#    de commandes déplaçant la tête de l'outil. La valeur par défaut est de ne pas exécuter de
#    commandes G-code spéciales lors de la désactivation.

#-----------------------------------------------------------------#

[output_pin probe_reset_pin]
pin: PB13

#-----------------------------------------------------------------#

[gcode_macro probe_reset]
gcode:
    SET_PIN PIN=probe_reset_pin VALUE=0
    G4 P300
    SET_PIN PIN=probe_reset_pin VALUE=1
    G4 P100

####################################################################
# PROTECTION THERMAL
####################################################################

[verify_heater extruder]
max_error: 130
#    L'erreur de température cumulée maximale avant de déclencher une erreur.
#    Des valeurs plus petites entraînent une vérification plus stricte et des valeurs
#    plus grandes permettent un délai plus long avant qu'une erreur ne soit signalée.
#    Plus précisément, la température est inspectée une fois par seconde et si elle
#    est proche de la température cible, un "compteur d'erreurs" interne est remis
#    à zéro; sinon, si la température est inférieure à la plage cible, le compteur est
#    augmenté de la quantité de température rapportée différant de cette plage. Si
#    le compteur dépasse ce "max_error", une erreur est signalée. La valeur par
#    défaut est 120.
#check_gain_time:
#    Ceci contrôle la vérification du chauffage durant la chauffe initiale. Des valeurs
#    plus petites entraînent une vérification plus stricte et des valeurs plus grandes
#    autorisent un délai plus grand avant qu'une erreur ne soit signalée. Spécifiquement,
#    pendant la chauffe initiale, tant que la température de l'élément chauffant augmente
#    durant ce laps de temps (spécifié en secondes), le "compteur d'erreurs" interne est
#    remis à zéro. La valeur par défaut est de 20 secondes pour les extrudeuses et 60
#    secondes pour le lit chauffant.
hysteresis: 5
#    La différence de température maximale (en Celsius) par rapport à une température
#    cible considérée comme située dans la plage de la cible. Ceci contrôle la vérification
#    de la plage du paramètre max_error. Il est rare de personnaliser cette valeur.
#    La valeur par défaut est 5.
#heating_gain: 2
#    La température minimale (en Celsius) pour laquelle le chauffage doit progresser
#    pendant la période de check_gain_time. Il est rare de personnaliser cette valeur.
#    La valeur par défaut est 2.

#-----------------------------------------------------------------#

[verify_heater heater_bed]
max_error: 120
#    L'erreur de température cumulée maximale avant de déclencher une erreur.
#    Des valeurs plus petites entraînent une vérification plus stricte et des valeurs
#    plus grandes permettent un délai plus long avant qu'une erreur ne soit signalée.
#    Plus précisément, la température est inspectée une fois par seconde et si elle
#    est proche de la température cible, un "compteur d'erreurs" interne est remis
#    à zéro; sinon, si la température est inférieure à la plage cible, le compteur est
#    augmenté de la quantité de température rapportée différant de cette plage. Si
#    le compteur dépasse ce "max_error", une erreur est signalée. La valeur par
#    défaut est 120.
#check_gain_time:
#    Ceci contrôle la vérification du chauffage durant la chauffe initiale. Des valeurs
#    plus petites entraînent une vérification plus stricte et des valeurs plus grandes
#    autorisent un délai plus grand avant qu'une erreur ne soit signalée. Spécifiquement,
#    pendant la chauffe initiale, tant que la température de l'élément chauffant augmente
#    durant ce laps de temps (spécifié en secondes), le "compteur d'erreurs" interne est
#    remis à zéro. La valeur par défaut est de 20 secondes pour les extrudeuses et 60
#    secondes pour le lit chauffant.
hysteresis: 5
#    La différence de température maximale (en Celsius) par rapport à une température
#    cible considérée comme située dans la plage de la cible. Ceci contrôle la vérification
#    de la plage du paramètre max_error. Il est rare de personnaliser cette valeur.
#   La valeur par défaut est 5.
#heating_gain: 2
#    La température minimale (en Celsius) pour laquelle le chauffage doit progresser
#    pendant la période de check_gain_time. Il est rare de personnaliser cette valeur.
#    La valeur par défaut est 2.

####################################################################
# CAPTEUR DE FIN DE FILAMENT
####################################################################

[filament_switch_sensor filament_sensor]
switch_pin: PA5
#    La broche sur laquelle l'interrupteur est connecté. Ce paramètre doit être fourni.
pause_on_runout: False
#    Lorsque défini sur True, une PAUSE sera exécutée immédiatement après qu'un runout
#    soit détecté. Notez que si pause_on_runout est False et que le runout_gcode est omis,
#    la détection du runout est désactivée. Par défaut, est True.
runout_gcode:
	PAUSE
	M104 S0
	RESPOND MSG="GoToPanel:extrude"
	M400
	RESPOND MSG="Changez le filament..."
#    Une liste de commandes G-Code à exécuter après la détection d'une fin de filament.
#    Voir docs/Command_Templates.md pour le format G-Code. Si pause_on_runout est
#    réglé sur True, ce G-code sera exécuté après la fin de la PAUSE. Par défaut, aucune
#    commande G-Code n'est exécutée.
#insert_gcode:
#    Une liste de commandes G-Code à exécuter après qu'une insertion de filament soit détectée.
#    Voir docs/Command_Templates.md pour le format G-Code. La valeur par défaut est de
#    n'exécuter aucune commande G-Code, ce qui désactive la détection de l'insertion.
#event_delay  3.0
#    La durée minimale en secondes à attendre entre les événements.
#    Des événements déclenchés durant cette période seront silencieusement ignorés.
#    La valeur par défaut est de 3 secondes.
#pause_delay: 0.5
#    Le délai, en secondes, entre l'envoi de la commande de pause et l'exécution du runout_gcode.
#    Il peut être utile d'augmenter ce délai si OctoPrint présente un comportement étrange lors de
#    la pause. La valeur par défaut est 0.5 secondes.


####################################################################
# COMPENSATION DE RÉSONANCE
#-------------------------------------------------------------------
# SI VOUS SUPPRIMER LA CONFIGURATION GÉNÉRÉE AUTOMATIQUEMENT (EN BAS DE PAGE)
# DÉCOMMENTER -> SHAPER_TYPE_X, SHAPER_FREQ_X, SHAPER_TYPE_Y, SHAPER_FREQ_Y
####################################################################

[input_shaper]
#shaper_type_x: mzv
#    Si shaper_type n'est pas défini, ces deux paramètres peuvent être utilisés pour configurer
#    des formes d'entrée différentes pour les axes X et Y. Les valeurs supportées sont les
#    mêmes que celles du paramètre shaper_type.
#shaper_freq_x: 70.8
#    Fréquence (en Hz) de la mise en forme de l'entrée pour l'axe X. Il s'agit généralement
#    d'une fréquence de résonance de l'axe X que la mise en forme de l'entrée doit supprimer.
#    Pour les mises en forme plus complexes, comme les mises en forme à 2 ou 3 bosses EI
#    (2hump/3hump), ce paramètre peut être défini à partir de différentes considérations.
#    La valeur par défaut est 0, ce qui désactive la mise en forme de l'entrée pour l'axe X.
#shaper_type_y: 2hump_ei
#    Si shaper_type n'est pas défini, ces deux paramètres peuvent être utilisés pour configurer
#    des formes d'entrée différentes pour les axes X et Y. Les valeurs supportées sont les
#    mêmes que celles du paramètre shaper_type.
#shaper_freq_y: 46.6
#    Fréquence (en Hz) de la mise en forme de l'entrée pour l'axe Y. Il s'agit généralement
#    d'une fréquence de résonance de l'axe Y que la mise en forme de l'entrée doit supprimer.
#    Pour les mises en forme plus complexes, comme les mises en forme à 2 ou 3 bosses EI
#    (2hump/3hump), ce paramètre peut être défini à partir de différentes considérations.
#    La valeur par défaut est 0, ce qui désactive la mise en forme de l'entrée pour l'axe Y.


####################################################################
# PINS BEEPER - LED
####################################################################

[output_pin BEEPER_PIN]
pin: PB15
pwm: True
value: 0
shutdown_value: 0
cycle_time: 0.001
scale: 1

#-----------------------------------------------------------------#

[output_pin LED]
pin: mcu:PA13
pwm: False
value: 0

####################################################################
# AUTRES
####################################################################

[temperature_sensor Orange_pi]
sensor_type: temperature_host
#    Le micro-contrôleur à lire. La valeur par défaut est "mcu".

#-----------------------------------------------------------------#

[temperature_sensor Vyper_MCU]
sensor_type: temperature_mcu
#    Le micro-contrôleur à lire. La valeur par défaut est "mcu".

#-----------------------------------------------------------------#

[gcode_arcs]
resolution: 1.0
#    Un arc sera divisé en segments. La longueur de chaque segment sera égale à
#    la résolution en mm définie ci-dessus. Des valeurs plus faibles produiront un
#    arc plus fin, mais également plus de travail de votre machine. Les arcs plus
#    petits que la valeur configurée deviendront des lignes droites. La valeur par
#    défaut est 1 mm.

#-----------------------------------------------------------------#

[pause_resume]
#recover_velocity: 50.
#    Lorsque la capture/restauration est activée, la vitesse à laquelle retourner à
#    la position capturée (en mm/s). La valeur par défaut est 50,0 mm/s.

#-----------------------------------------------------------------#

[display_status]
#    Les informations suivantes sont disponibles dans l’objet display_status (cet objet est
#    automatiquement disponible si une section de configuration affichage est définie) :
#    progress : la valeur de progression de la dernière commande G-Code M73 (ou virtual_sdcard.progress
#    si aucune commande M73 récente n'a été reçue.
#    message : Le message contenu dans la dernière commande G-Code M117.

#-----------------------------------------------------------------#

[respond]
#default_type: echo
#    Définit le préfixe par défaut de la sortie "M118" et "RESPOND" à l'un des
#    éléments suivants :
#            echo: "echo : " (C'est la valeur par défaut)
#            command: "// "
#            error: " !! "
#default_prefix: echo:
#    Définit directement le préfixe par défaut. Si elle est présente, cette valeur
#    remplacera celle de "default_type".

#-----------------------------------------------------------------#

[exclude_object]
#    Permet de prendre en charge l'exclusion ou l'annulation d'objets
#    individuels pendant le processus d'impression.

####################################################################

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 32.723
#*# pid_ki = 2.371
#*# pid_kd = 112.893
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 66.236
#*# pid_ki = 0.901
#*# pid_kd = 1217.087
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 69.8
#*# shaper_type_y = 2hump_ei
#*# shaper_freq_y = 46.6
#*#
#*# [probe]
#*# z_offset = -0.100
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-1.928750, -1.912500, -1.877500, -1.898750, -1.863750, -1.820000, -1.853750, -1.841250, -1.940000
#*# 	-1.875000, -1.885000, -1.850000, -1.793750, -1.777500, -1.765000, -1.783750, -1.870000, -1.903750
#*# 	-1.902500, -1.875000, -1.851250, -1.817500, -1.831250, -1.815000, -1.832500, -1.876250, -1.947500
#*# 	-1.908750, -1.898750, -1.853750, -1.815000, -1.781250, -1.792500, -1.863750, -1.851250, -1.986250
#*# 	-1.948750, -1.891250, -1.830000, -1.836250, -1.817500, -1.826250, -1.900000, -1.910000, -2.016250
#*# 	-1.988750, -1.906250, -1.856250, -1.845000, -1.830000, -1.808750, -1.888750, -1.946250, -2.040000
#*# 	-2.013750, -1.898750, -1.878750, -1.860000, -1.851250, -1.813750, -1.913750, -1.973750, -2.096250
#*# 	-1.991250, -1.982500, -1.912500, -1.890000, -1.813750, -1.865000, -1.928750, -2.002500, -2.131250
#*# 	-2.092500, -2.033750, -1.947500, -1.931250, -1.915000, -1.918750, -1.946250, -2.052500, -2.145000
#*# x_count = 9
#*# y_count = 9
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 10.0
#*# max_x = 234.96
#*# min_y = 10.0
#*# max_y = 234.96
