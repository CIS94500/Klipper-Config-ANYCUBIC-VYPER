# Klipper Configurations - Anycubic Vyper
#	 ___      ___  ________  ___  ___  ________  
#	|"  \    /"  |/"       )|"  \/"  |/"       ) 
#	 \   \  //  /(:   \___/  \   \  /(:   \___/  
#	  \\  \/. ./  \___  \     \\  \/  \___  \    
#	   \.    //    __/  \\    /   /    __/  \\   
#	    \\   /    /" \   :)  /   /    /" \   :)  
#	     \__/    (_______/  |___/    (_______/   
# 
#   	01010110  01010011  01011001  01010011   
#
# Auteur: Virgile de Champigny
#
# To create the Firmware you need to use the following configuration:
#     - Micro-controller: STM32
#     - Processor model: STM32F103
#     - Disable SWD at startup: enabled
#     - Bootloader offset: 32KiB
#     - Communication interface: Serial (on USART1 PA10/PA9)
#
# To install the Firmware rename the klipper bin to `main_board_20xxxxxx.bin`
# and copy it to an SD Card.
# Power off the Printer, insert the SD Card and power it on.
# It should beep several times and the LCD should be stuck on the Splash screen.
# Now you should be able to connect to the Printer, you might need to change
# the mcu/serial setting in this config according to your set up.
# Run ls /dev/serial/by-id/* on your Linux OS to get YOUR serial or it wont connect
# If you want to revert the Firmware back to Marlin you simply need to flash it
# with a anycubic firmware through the SD Card

[include macros/*.cfg]
#[include adxl345.cfg]

####################################################################
# MAINBOARD / CONNECTED MCUS
####################################################################

[mcu]
serial: /dev/serial/by-id/usb-1a86_USB_Serial-if00-port0
#    Run ls /dev/serial/by-id/* on your Linux OS to get YOUR serial or it wont connect
#    Le port série à connecter à l'unité MCU. Si vous n'êtes pas sûr (ou s'il
#    change) consultez la section "Où est mon port série ?" de la FAQ.
#    Ce paramètre doit être fourni lors de l'utilisation d'un port série.
#baud: 250000
#    Le débit en bauds à utiliser. La valeur par défaut est 250000.
restart_method: command
#    Ceci contrôle le mécanisme que l'hôte utilisera pour réinitialiser le microcontrôleur.
#    Les choix sont 'arduino', 'cheetah', 'rpi_usb', et 'command'. La méthode 'arduino'
#    (basculer DTR) est courante sur les cartes et clones Arduino.
#    La méthode 'cheetah' est une méthode particulière nécessaire pour certaines cartes
#    Fysetc Cheetah. La méthode 'rpi_usb' est utile sur les cartes Raspberry Pi avec des
#    micro-contrôleurs alimentés par USB - elle désactive brièvement l'alimentation de tous
#    les ports USB pour effectuer une réinitialisation du microcontrôleur.
#    La méthode 'command' implique l'envoi d'une commande Klipper au microcontrôleur
#    afin qu'il puisse # se réinitialiser.
#    La valeur par défaut est 'arduino' si le micro-contrôleur communique via un port série,
#    'command' sinon.

####################################################################
# MACHINE ABSOLUTE LIMITS
####################################################################

[safe_z_home]
home_xy_position: -3,-7
#    Une coordonnée X, Y (par exemple 100, 100) où la mise à l'origine Z
#    doit être effectuée. Ce paramètre doit être fourni.
#speed: 50.0
#    Vitesse à laquelle la tête de l'outil est déplacée vers la position de
#    référence Z sûre. La valeur par défaut est 50 mm/s
z_hop: 10
#    Distance (en mm) pour lever l'axe Z avant le retour au point d'origine.
#    Cette valeur est appliquée à toute commande d'initialisation, même
#    si elle n'initialise pas l'axe Z. Si l'axe Z est déjà ramené à la position
#    de base et que la position Z actuelle est inférieure à z_hop, alors ceci
#    lèvera la tête à une hauteur de z_hop. Si l'axe Z n'est pas déjà centré,
#    la tête est relevée de z_hop.
#    La valeur par défaut est de ne pas implémenter le relevage en Z.
#z_hop_speed: 15.0
#    Vitesse (en mm/s) à laquelle l'axe Z est relevé avant le retour à la
#    position initiale. La valeur par défaut est de 15 mm/s.
#move_to_previous: False
#    Lorsqu'il a la valeur True, les axes X et Y sont réinitialisés à leurs
#    positions précédentes après retour à la position initiale de l'axe Z.
#    La valeur par défaut est False.

#-----------------------------------------------------------------#

[printer]
kinematics: cartesian
#    Le type d'imprimante utilisée. Cette option peut être l'une des suivantes : cartésienne,
#    corexy, corexz, hybrid_corexy, hybrid_corexz, rotary_delta, delta, deltesian, polar, winch,
#    ou none. Ce paramètre doit être spécifié.
#POUR TOUT CHANGEMENT VOIR LA MACRO FACTORY_RESET (macros/start_end.cfg)
max_velocity: 300
#    Vitesse maximale (en mm/s) de la tête d'outil (par rapport à l'impression).
#    Ce paramètre doit être spécifié.
max_accel: 2400
#    Accélération maximale (en mm/s^2) de la tête de l'outil (par rapport à l'impression).
#    Ce paramètre doit être spécifié.
#max_accel_to_decel: 1900
#    Une pseudo-accélération (en mm/s^2) contrôlant la vitesse à laquelle la tête de l'outil peut
#    passer de l'accélération à la décélération. Elle est utilisée pour réduire la vitesse maximale
#    des courts mouvements en zigzag (et donc réduire les vibrations de l'imprimante dues à ces
#    mouvements). La valeur par défaut est la moitié de max_accel.
square_corner_velocity: 5
#    La vitesse maximale (en mm/s) à laquelle la tête d'outil peut parcourir un angle de 90 degrés.
#    Une valeur non nulle peut réduire les changements dans les débits de l'extrudeuse en
#    permettant des changements de vitesse instantanés de la tête d'outil pendant les virages.
#    Cette valeur configure l'algorithme interne de prise de virage à vitesse centripète ; les virages
#    dont l'angle est supérieur à 90 degrés auront une vitesse de prise de virage plus élevée tandis
#    que ceux d'angles inférieurs à 90 degrés auront une vitesse de virage plus faible.
#    Si ce paramètre est défini sur zéro, la tête d'outil décélérera jusqu'à zéro à chaque coin.
#    La valeur par défaut est 5mm/s.
max_z_velocity: 60
#    Ceci définit la vitesse maximale (en mm/s) du mouvement le long de l'axe z
#    Ce paramètre peut être utilisé pour limiter la vitesse maximale du moteur pas à pas z.
#    La valeur par défaut est l'utilisation de max_velocity pour max_z_velocity.
max_z_accel: 100
#    Ce paramètre définit l'accélération maximale (en mm/s^2) du mouvement sur l'axe z.
#    Cela limite l'accélération du moteur pas à pas z. La valeur par défaut est
#    d'utiliser max_accel pour max_z_accel.

####################################################################
# IDLE TIME-OUT
####################################################################

[idle_timeout]
#   Time in seconds (300 = 5 minutes)
#   A list of G-Code commands to execute on an idle timeout. See
#   docs/Command_Templates.md for G-Code format. The default is to run
#   "TURN_OFF_HEATERS" and "M84".
timeout: 1800
#   Idle time (in seconds) to wait before running the above G-Code
#   commands. The default is 600 seconds.

####################################################################
# STEEPER
####################################################################

[stepper_x]
step_pin: PC2
dir_pin: PB9
enable_pin: !PC3
microsteps: 16
rotation_distance: 40
full_steps_per_rotation: 200
endstop_pin: !PA7
position_min: -3
position_endstop: -3
position_max: 245
homing_speed: 30.0

#-----------------------------------------------------------------#

[stepper_y]
step_pin: PB8
dir_pin: PB7
enable_pin: !PC13
microsteps: 16
rotation_distance: 32
full_steps_per_rotation: 200
endstop_pin: !PC5
position_min: -10
position_endstop: -10
position_max: 250
homing_speed: 30.0

#-----------------------------------------------------------------#

[stepper_z]
step_pin: PB6
dir_pin: !PB5
enable_pin: !PC14
microsteps: 16
rotation_distance: 8
full_steps_per_rotation: 200
endstop_pin: PB2
position_endstop: 0.0
position_max: 260
position_min: -3
homing_speed: 5.0

#-----------------------------------------------------------------#

[stepper_z1]
step_pin: PC0
dir_pin: !PC1
enable_pin: !PC15
microsteps: 16
rotation_distance: 8
full_steps_per_rotation: 200
endstop_pin: PC6

####################################################################
# EXTRUDEUR CONFIGURATION
####################################################################

[extruder]
step_pin: PB4
#    Broche GPIO du moteur (déclenchée à l'état haut). Ce paramètre doit être fourni.
dir_pin: !PB3
#    Broche GPIO de direction (le niveau haut indique une direction positive). Ce paramètre
#    doit être fourni
enable_pin: !PA15
#    Broche d'activation (par défaut, enable est haut ; utilisez ! pour indiquer enable
#    bas). Si ce paramètre n'est pas fourni, le pilote du moteur pas à pas doit toujours
#    être activé.
microsteps: 16
#    Le nombre de micropas utilisés par le pilote du moteur pas à pas. Ce paramètre
#    doit être fourni.
rotation_distance: 22.248
#	 rotation_distance = <previous_rotation_distance> * <actual_extrude_distance> / <requested_extrude_distance>
#	 default value get this from the bondtech hob gear. measure the hob on the lever that
#	 value x 3.14 = rotation distance. flow in slicer should be within 10 percent up or down.
#	 filament tolerance and density will affect flow actual flow.
#    Distance (en mm) parcourue par l'axe lors d'une rotation complète du moteur pas à pas
#    (ou de l'engrenage final si le rapport de vitesse est spécifié).
#    Ce paramètre doit être fourni.
full_steps_per_rotation: 200
#    Nombre de pas complets pour une rotation complète du moteur pas à pas.
#    Réglez ce paramètre sur 200 pour un moteur pas à pas de 1,8 degré ou sur 400 pour
#    un moteur de 0,9 degré. La valeur par défaut est 200.
gear_ratio: 50:17
#   Le rapport d'engrenage si le moteur pas à pas est relié à l'axe via une démultiplication.
#   Par exemple, on peut spécifier "5:1" si un réducteur de 5 pour 1 est utilisé.
#   Si l'axe a plusieurs démultiplications, on peut spécifier une liste de rapports séparés par
#   des virgules (par exemple, "57:11, 2:1"). Si un rapport de vitesse est spécifié, alors
#   rotation_distance spécifie la distance parcourue par l'axe pour une rotation complète
#   de l'engrenage final.
#   La valeur par défaut est de ne pas utiliser de rapport de vitesse.
nozzle_diameter: 0.400
#   Diamètre de l'orifice de la buse (en mm). Ce paramètre doit être fourni.
filament_diameter: 1.750
#   Diamètre moyen du filament (en mm) lorsqu'il entre dans l'extrudeuse.
#   Ce paramètre doit être fourni.
heater_pin: PA1
#   PWM output pin controlling the heater. This parameter must be
#   provided.
sensor_type: ATC Semitec 104GT-2
#   Type of sensor - common thermistors are "EPCOS 100K B57560G104F",
#   "ATC Semitec 104GT-2", "ATC Semitec 104NT-4-R025H42G", "Generic
#   3950","Honeywell 100K 135-104LAG-J01", "NTC 100K MGB18-104F39050L32",
#   "SliceEngineering 450", and "TDK NTCG104LH104JT1". See the
#   "Temperature sensors" section for other sensors. This parameter
#   must be provided.
sensor_pin: PC4
#   Analog input pin connected to the sensor. This parameter must be
#   provided.22.466
#control: pid
#   Control algorithm (either pid or watermark). This parameter must
#   be provided.
#pid_kp: 31.799
#pid_ki: 2.255
#pid_kd: 112.092
#   The proportional (pid_Kp), integral (pid_Ki), and derivative
#   (pid_Kd) settings for the PID feedback control system. Klipper
#   evaluates the PID settings with the following general formula:
#   heater_pwm = (Kp*error + Ki*integral(error) - Kd*derivative(error)) / 255
#   Where "error" is "requested_temperature - measured_temperature"
#   and "heater_pwm" is the requested heating rate with 0.0 being full
#   off and 1.0 being full on. Consider using the PID_CALIBRATE
#   command to obtain these parameters. The pid_Kp, pid_Ki, and pid_Kd
#   parameters must be provided for PID heaters.
min_temp: 0
max_temp: 260
#   The maximum range of valid temperatures (in Celsius) that the
#   heater must remain within. This controls a safety feature
#   implemented in the micro-controller code - should the measured
#   temperature ever fall outside this range then the micro-controller
#   will go into a shutdown state. This check can help detect some
#   heater and sensor hardware failures. Set this range just wide
#   enough so that reasonable temperatures do not result in an error.
#   These parameters must be provided.
pressure_advance: 0
#	Set this from the slicer / Mainsail.
#	or start gcode its easier to do this in slicers with material specic gcode functions.
#	0.1-1.5 layer hight isn't usally benificial.
#   The amount of raw filament to push into the extruder during
#   extruder acceleration. An equal amount of filament is retracted
#   during deceleration. It is measured in millimeters per
#   millimeter/second. The default is 0, which disables pressure
#   advance.
pressure_advance_smooth_time: 0.040
#   A time range (in seconds) to use when calculating the average
#   extruder velocity for pressure advance. A larger value results in
#   smoother extruder movements. This parameter may not exceed 200ms.
#   This setting only applies if pressure_advance is non-zero. The
#   default is 0.040 (40 milliseconds).
max_extrude_only_distance: 500.0
#   Longueur maximale (en mm de filament) qu'un mouvement de rétraction ou d'extrusion
#   peut fournir. Si un mouvement de rétraction ou d'extrusion unique demande une
#   distance supérieure à cette valeur, une erreur sera renvoyée.
#   La valeur par défaut est 50mm.
instantaneous_corner_velocity: 15
# 	The equivalent of extruder jerk. this does not speed up pressue advance
#   La variation instantanée maximale de la vitesse (en mm/s) de l'extrudeuse
#   pendant la jonction de deux mouvements. La valeur par défaut est 1mm/s..
max_extrude_only_accel: 2000
#   Maximum velocity (in mm/s) and acceleration (in mm/s^2) of the
#   extruder motor for retractions and extrude-only moves. These
#   settings do not have any impact on normal printing moves. If not
#   specified then they are calculated to match the limit an XY
#   printing move with a cross section of 4.0*nozzle_diameter^2 would
#   have.
max_extrude_cross_section: 50
# 	3:1 = /3 = 2800 (stock xyz acc) The rough gear ratio of bondtech.
#   Surface maximale (en mm^2) d'une section transversale d'extrusion (ex:
#   largeur de l'extrusion multipliée par la hauteur de la couche). Ce paramètre
#   permet d'éviter d'extruder des quantités excessives durant de petits déplacements
#   XY. Si un déplacement demande une quantité d'extrusion supérieure à cette valeur,
#   une erreur sera renvoyée. La valeur par défaut est 4.0 *diamètre_buse^2

####################################################################
# BED CONFIGURATION
####################################################################

[heater_bed]
heater_pin: PA4
#   PWM output pin controlling the heater. This parameter must be
#   provided.
sensor_type: EPCOS 100K B57560G104F
#    Un parmi "EPCOS 100K B57560G104F", "ATC Semitec 104GT-2",
#    "ATC Semitec 104NT-4-R025H42G", "Generic 3950",
#    "Honeywell 100K 135-104LAG-J01", "NTC 100K MGB18-104F39050L32",
#    "SliceEngineering 450", ou "TDK NTCG104LH104JT1"
sensor_pin: PB0
#    Broche d'entrée analogique connectée à la thermistance. Ce paramètre doit
#    être fourni.
min_temp: -5
max_temp: 110
#   La plage maximale de températures valides (Celsius) dans laquelle l'élément de
#   chauffe doit rester. Ceci contrôle une fonction de sécurité implémentée dans le code
#   du micro-contrôleur - si la température mesurée sort de cette plage, le microcontrôleur
#   se met en état d'arrêt. Ce contrôle peut aider à détecter certaines défaillances matérielles
#   de l'élément chauffant et/ou du capteur. Définissez cette plage suffisamment large pour
#   que des températures raisonnables n'entraînent pas d'erreur.
#   Ces paramètres doivent être fournis.
#control: pid
#   Algorithme de contrôle (soit pid, soit watermark). Ce paramètre doit être fourni.
#pid_kp: 64.650
#pid_ki: 0.662
#pid_kd: 1578.277
#    Les paramètres proportionnels (pid_Kp), intégraux (pid_Ki), et dérivés (pid_Ki)
#    du système de contrôle par rétroaction PID. Klipper évalue les paramètres PID
#    avec la formule générale suivante :
#        fan_pwm = max_power - (Kp*e + Ki*integral(e) - Kd*derivative(e)) / 255
#    Où "e" est "température_cible - température_mesurée" et
#    "fan_pwm" est le débit du ventilateur demandé, 0,0 correspondant à un arrêt complet
#    et 1,0 correspond à un fonctionnement à plein régime. Les paramètres pid_Kp, pid_Ki,
#    et pid_Kd doivent être fournis lorsque l'algorithme de contrôle PID est activé.

####################################################################
# REFROIDISSEMENT
####################################################################

[heater_fan extruder_fan]
pin: PB1
#   Broche de sortie contrôlant le ventilateur. Ce paramètre doit être fourni.
max_power: 1.0
#    La puissance maximale (exprimée en tant que valeur comprise entre 0,0 et 1,0) à laquelle
#    régler la broche. La valeur 1.0 permet de régler la broche entièrement activée pendant de
#    longues périodes, tandis qu'une valeur de 0,5 permet à la broche de n'être activée que
#    durant la moitié du temps au maximum. Ce paramètre peut être utilisé pour limiter la
#    puissance totale de sortie (sur des périodes prolongées) du ventilateur.
#    Si cette valeur est inférieure à 1,0, les demandes de vitesse du ventilateur seront mises à
#    l'échelle entre zéro et max_power (par exemple, si la puissance maximale est de 0,9 et
#    qu'une vitesse de 80 % est demandée, la puissance du ventilateur sera réglée à 72 %.
#    La valeur par défaut est 1.0.
heater: extruder
#   Name of the config section defining the heater that this fan is
#   associated with. If a comma separated list of heater names is
#   provided here, then the fan will be enabled when any of the given
#   heaters are enabled. The default is "extruder".
heater_temp: 40.0
#   A temperature (in Celsius) that the heater must drop below before
#   the fan is disabled. The default is 50 Celsius.
fan_speed: 1.0
#   The fan speed (expressed as a value from 0.0 to 1.0) that the fan
#   will be set to when its associated heater is enabled. The default
#   is 1.0
#cycle_time:
#   The amount of time (in seconds) for each PWM power cycle to the
#   fan. It is recommended this be 10 milliseconds or greater when
#   using software based PWM. The default is 0.010 seconds.
kick_start_time: 0.0
#   Time (in seconds) to run the fan at full speed when either first
#   enabling or increasing it by more than 50% (helps get the fan
#   spinning). The default is 0.100 seconds.

#-----------------------------------------------------------------#

[fan]
pin: PA0
#   Broche de sortie contrôlant le ventilateur. Ce paramètre doit être fourni.
max_power: 1.0
#    La puissance maximale (exprimée en tant que valeur comprise entre 0,0 et 1,0) à laquelle
#    régler la broche. La valeur 1.0 permet de régler la broche entièrement activée pendant de
#    longues périodes, tandis qu'une valeur de 0,5 permet à la broche de n'être activée que
#    durant la moitié du temps au maximum. Ce paramètre peut être utilisé pour limiter la
#    puissance totale de sortie (sur des périodes prolongées) du ventilateur.
#    Si cette valeur est inférieure à 1,0, les demandes de vitesse du ventilateur seront mises à
#    l'échelle entre zéro et max_power (par exemple, si la puissance maximale est de 0,9 et
#    qu'une vitesse de 80 % est demandée, la puissance du ventilateur sera réglée à 72 %.
#    La valeur par défaut est 1.0.
#cycle_time:
#    La durée (en secondes) de chaque cycle d'alimentation PWM du ventilateur. Il est
#    recommandé que cette durée soit de 10 millisecondes ou plus si vous utilisez un PWM logiciel.
#    La valeur par défaut est de 0,010 seconde.
kick_start_time: 0.0
#    Durée (en secondes) de fonctionnement du ventilateur à pleine vitesse, soit lors de sa première
#    activation soit lors d'une augmentation de plus de 50% (pour faire tourner le ventilateur).
#    La valeur par défaut est de 0,100 seconde.

#-----------------------------------------------------------------#

[controller_fan Mainboard]
pin: PA14
#   Broche de sortie contrôlant le ventilateur. Ce paramètre doit être fourni.
max_power: 1.0
#    La puissance maximale (exprimée en tant que valeur comprise entre 0,0 et 1,0) à laquelle
#    régler la broche. La valeur 1.0 permet de régler la broche entièrement activée pendant de
#    longues périodes, tandis qu'une valeur de 0,5 permet à la broche de n'être activée que
#    durant la moitié du temps au maximum. Ce paramètre peut être utilisé pour limiter la
#    puissance totale de sortie (sur des périodes prolongées) du ventilateur.
#    Si cette valeur est inférieure à 1,0, les demandes de vitesse du ventilateur seront mises à
#    l'échelle entre zéro et max_power (par exemple, si la puissance maximale est de 0,9 et
#    qu'une vitesse de 80 % est demandée, la puissance du ventilateur sera réglée à 72 %.
#    La valeur par défaut est 1.0.
fan_speed: 1.0
#   Vitesse du ventilateur (exprimée comme une valeur de 0,0 à 1,0) à laquelle celui-ci
#   sera réglé lorsqu'un chauffage ou un pilote pas à pas est actif.
#   La valeur par défaut est 1.0
idle_timeout: 60
#   Durée (en secondes) après activité d'un pilote pas à pas ou d'un élément chauffant
#   pour laquelle le ventilateur doit continuer de fonctionner. La valeur par défaut
#   est de 30 secondes.
heater: extruder, heater_bed
stepper: stepper_x, stepper_y, stepper_z, extruder
#   Nom de la section de configuration définissant l'élément chauffant/pilote auquel ce ventilateur
#   est associé. Si une liste séparée par des virgules de noms d'éléments chauffants/pilotes est
#   fournie ici, le ventilateur s'activera lorsque l'un des éléments chauffants/pilotes donnés est activé.
#   Le chauffage par défaut est "extruder", le pilote par défaut est tous.

####################################################################
# BED MESH - PROBE - PROBE RESET PIN - PROBE RESET
####################################################################

[bed_mesh]
speed: 50
#   La vitesse (en mm/s) des déplacements entre les points de palpage
#   durant l'étalonnage.
#   La valeur par défaut est 50.
horizontal_move_z: 1.0
#   La hauteur (en mm) à laquelle la tête doit être relevée juste avant de
#   lancer une opération de palpage. La valeur par défaut est 5.
mesh_min: 10, 10
#   Définit les coordonnées X, Y minimales du maillage pour les lits
#   rectangulaires. Ces coordonnées sont relatives à l'emplacement de la
#   sonde. Cette position sera le premier point sondé, le plus proche de
#   l'origine. Ce paramètre doit être fourni pour des lits rectangulaires.
mesh_max: 235, 235
#   Définit les coordonnées X, Y maximales du maillage pour les lits
#   rectangulaires. Le principe est le même que pour mesh_min, mais ce
#   sera le point le plus éloigné atteignable par rapport à l'origine du lit.
#   Ce paramètre  doit être fourni pour des lits rectangulaires.
probe_count: 7, 7
#   Pour les lits rectangulaires, il s'agit d'une paire d'entiers X, Y séparés par
#   des virgules, définissant le nombre de points à palper le long de chaque
#   axe. Une valeur seule est également valide, auquel cas cette valeur sera
#   appliquée aux deux axes. La valeur par défaut est 3, 3.
#move_check_distance: 5.0
#   La distance (en mm) le long d'un mouvement pour vérifier le split_delta_z.
#   C'est également la longueur minimale pour laquelle un mouvement peut
#   être divisé. La valeur par défaut est 5.0.
mesh_pps: 2, 2
#   Une paire de nombres entiers X, Y séparés par des virgules, définissant le
#   nombre de points par segment à interpoler dans le maillage le long de
#   chaque axe. Un "segment" étant défini comme l'espace entre chaque point
#   palpé. L'utilisateur peut saisir une seule valeur s'appliquant alors aux
#   deux axes. La valeur par défaut est 2, 2.
algorithm: bicubic
#   L'algorithme d'interpolation à utiliser. Soit "lagrange", soit "bicubic".
#   Cette option n'affecte pas les grilles 3x3 forcées d'utiliser l'échantillonnage
#   de lagrange. La valeur par défaut est lagrange.
#bicubic_tension: .2
#   Lors de l'utilisation de l'algorithme bicubic, le paramètre de tension ci-
#   dessus peut être appliqué pour modifier la quantité de pente interpolée.
#   Des nombres plus grands augmenteront la quantité de pente entraînant
#   une plus grande courbure du maillage. La valeur par défaut est 0,2.
fade_start: 1.0
#   La position z du gcode à partir de laquelle il faut commencer à éliminer
#   progressivement l'ajustement z lorsque la compensation est activée.
#   La valeur par défaut est 1.0.
fade_end: 10.0
#   La position z du gcode à partir de laquelle la compensation se termine.
#   Lorsqu'elle est définie à une valeur inférieure à fade_start, la compensation
#   est désactivée. Notez que la compensation peut ajouter une mise à l'échelle
#   indésirable le long de l'axe z d'une impression. Si un utilisateur souhaite
#   activer la compensation, une valeur de 10.0 est recommandée.
#   La valeur par défaut est 0.0, ce qui désactive la compensation.

#-----------------------------------------------------------------#

[probe]
pin: !PB12
#    Broche de détection de la sonde. Si la broche se trouve sur un microcontrôleur différent
#    de celui des moteurs de l'axe Z alors elle active le "multi-mcu homing". Ce paramètre
#    doit être fourni.
#deactivate_on_each_sample: True
#    Ceci détermine si Klipper doit exécuter le gcode de désactivation entre chaque tentative
#    de palpage lors d'une séquence de palpages multiples.
#    La valeur par défaut est True.
#x_offset: 0.0
#    La distance (en mm) entre la sonde et la buse le long de l'axe x.
#    La valeur par défaut est 0.
#y_offset: 0.0
#    La distance (en mm) entre la sonde et la buse le long de l'axe y.
#    La valeur par défaut est 0.
#z_offset: 0
#    La distance (en mm) entre le lit et la buse lorsque la sonde se déclenche.
#    Ce paramètre doit être fourni.
speed: 1.0
#    Vitesse (en mm/s) de l'axe Z lors du palpage. La valeur par défaut est 5mm/s.
samples: 2
#    Le nombre de fois où il faut palper chaque point. Les valeurs z palpées seront
#    moyennées. La valeur par défaut est de palper 1 fois.
#sample_retract_dist: 2.0
#    Distance (en mm) à parcourir pour relever la tête de l'outil entre chaque palpage
#    (en cas d'échantillonnage multiple). La valeur par défaut est 2mm.
#lift_speed:
#    Vitesse (en mm/s) de l'axe Z lors du levage de la sonde entre les échantillons.
#    La valeur par défaut est la même que celle du paramètre 'speed'.
#samples_result: average
#    La méthode de calcul lorsque l'on échantillonne plusieurs fois - soit "médiane"
#    (median) ou "moyenne" (average). La valeur par défaut est "moyenne".
samples_tolerance: 0.100
#    La distance Z maximale (en mm) à laquelle un échantillon peut différer des autres
#    échantillons. Si cette tolérance est dépassée, soit une erreur est signalée soit une
#    tentative de palpage est recommencée (cf. samples_tolerance_retries).
#    La valeur par défaut est 0.100mm.
#samples_tolerance_retries: 0
#    Le nombre de fois qu'il faut réessayer quand un palpage dépasse la tolérance des
#    échantillons. Lors d'une nouvelle tentative, tous les échantillons en cours sont rejetés
#    et une tentative de palpa est relancée. Si un ensemble valide d'échantillons n'est pas
#    obtenu dans le nombre de tentatives donné, une erreur est signalée. La valeur par défaut
#    est zéro, ce qui entraîne le signalement d'une erreur dès le premier échantillon dépassant
#    la tolérance de samples_tolerance.
activate_gcode:
    probe_reset
#    Une liste de commandes G-Code à exécuter avant chaque tentative de palpage.
#    Voir docs/Command_Templates.md pour le format G-Code. Cela peut être  utile si la sonde
#    doit être activée d'une manière particulière. Ne pas envoyer ici de commandes déplaçant
#    la tête de l'outil (par exemple, G1). La valeur par défaut est de ne pas exécuter de commandes
#    G-code spéciales lors de l'activation.
#deactivate_gcode:
#    Une liste de commandes G-Code à exécuter après la fin de chaque tentative de palpage
#    terminée. Voir docs/Command_Templates.md pour le format G-Code. Ne pas envoyer ici
#    de commandes déplaçant la tête de l'outil. La valeur par défaut est de ne pas exécuter de
#    commandes G-code spéciales lors de la désactivation.

#-----------------------------------------------------------------#

[output_pin probe_reset_pin]
pin: PB13

#-----------------------------------------------------------------#

[gcode_macro probe_reset]
gcode:
    SET_PIN PIN=probe_reset_pin VALUE=0
    G4 P300
    SET_PIN PIN=probe_reset_pin VALUE=1
    G4 P100

####################################################################
# PROTECTION THERMAL
####################################################################

[verify_heater extruder]
max_error: 130
#    L'erreur de température cumulée maximale avant de déclencher une erreur.
#    Des valeurs plus petites entraînent une vérification plus stricte et des valeurs
#    plus grandes permettent un délai plus long avant qu'une erreur ne soit signalée.
#    Plus précisément, la température est inspectée une fois par seconde et si elle
#    est proche de la température cible, un "compteur d'erreurs" interne est remis
#    à zéro; sinon, si la température est inférieure à la plage cible, le compteur est
#    augmenté de la quantité de température rapportée différant de cette plage. Si
#    le compteur dépasse ce "max_error", une erreur est signalée. La valeur par
#    défaut est 120.
#check_gain_time:
#    Ceci contrôle la vérification du chauffage durant la chauffe initiale. Des valeurs
#    plus petites entraînent une vérification plus stricte et des valeurs plus grandes
#    autorisent un délai plus grand avant qu'une erreur ne soit signalée. Spécifiquement,
#    pendant la chauffe initiale, tant que la température de l'élément chauffant augmente
#    durant ce laps de temps (spécifié en secondes), le "compteur d'erreurs" interne est
#    remis à zéro. La valeur par défaut est de 20 secondes pour les extrudeuses et 60
#    secondes pour le lit chauffant.
hysteresis: 5
#    La différence de température maximale (en Celsius) par rapport à une température
#    cible considérée comme située dans la plage de la cible. Ceci contrôle la vérification
#    de la plage du paramètre max_error. Il est rare de personnaliser cette valeur.
#   La valeur par défaut est 5.
#heating_gain: 2
#    La température minimale (en Celsius) pour laquelle le chauffage doit progresser
#    pendant la période de check_gain_time. Il est rare de personnaliser cette valeur.
#    La valeur par défaut est 2.

#-----------------------------------------------------------------#

[verify_heater heater_bed]
max_error: 120
#    L'erreur de température cumulée maximale avant de déclencher une erreur.
#    Des valeurs plus petites entraînent une vérification plus stricte et des valeurs
#    plus grandes permettent un délai plus long avant qu'une erreur ne soit signalée.
#    Plus précisément, la température est inspectée une fois par seconde et si elle
#    est proche de la température cible, un "compteur d'erreurs" interne est remis
#    à zéro; sinon, si la température est inférieure à la plage cible, le compteur est
#    augmenté de la quantité de température rapportée différant de cette plage. Si
#    le compteur dépasse ce "max_error", une erreur est signalée. La valeur par
#    défaut est 120.
#check_gain_time:
#    Ceci contrôle la vérification du chauffage durant la chauffe initiale. Des valeurs
#    plus petites entraînent une vérification plus stricte et des valeurs plus grandes
#    autorisent un délai plus grand avant qu'une erreur ne soit signalée. Spécifiquement,
#    pendant la chauffe initiale, tant que la température de l'élément chauffant augmente
#    durant ce laps de temps (spécifié en secondes), le "compteur d'erreurs" interne est
#    remis à zéro. La valeur par défaut est de 20 secondes pour les extrudeuses et 60
#    secondes pour le lit chauffant.
hysteresis: 5
#    La différence de température maximale (en Celsius) par rapport à une température
#    cible considérée comme située dans la plage de la cible. Ceci contrôle la vérification
#    de la plage du paramètre max_error. Il est rare de personnaliser cette valeur.
#   La valeur par défaut est 5.
#heating_gain: 2
#    La température minimale (en Celsius) pour laquelle le chauffage doit progresser
#    pendant la période de check_gain_time. Il est rare de personnaliser cette valeur.
#    La valeur par défaut est 2.

####################################################################
# CAPTEUR DE FIN DE FILAMENT
####################################################################

[filament_switch_sensor filament_sensor]
pause_on_runout: True
#    Lorsque défini sur True, une PAUSE sera exécutée immédiatement après qu'un runout
#    soit détecté. Notez que si pause_on_runout est False et que le runout_gcode est omis,
#    la détection du runout est désactivée. Par défaut, est True.
#runout_gcode:
#    Une liste de commandes G-Code à exécuter après la détection d'une fin de filament.
#    Voir docs/Command_Templates.md pour le format G-Code. Si pause_on_runout est
#    réglé sur True, ce G-code sera exécuté après la fin de la PAUSE. Par défaut, aucune
#    commande G-Code n'est exécutée.
#insert_gcode:
#    Une liste de commandes G-Code à exécuter après qu'une insertion de filament soit détectée.
#    Voir docs/Command_Templates.md pour le format G-Code. La valeur par défaut est de
#    n'exécuter aucune commande G-Code, ce qui désactive la détection de l'insertion.
#event_delay  3.0
#    La durée minimale en secondes à attendre entre les événements.
#    Des événements déclenchés durant cette période seront silencieusement ignorés.
#    La valeur par défaut est de 3 secondes.
#pause_delay: 0.5
#    Le délai, en secondes, entre l'envoi de la commande de pause et l'exécution du runout_gcode.
#    Il peut être utile d'augmenter ce délai si OctoPrint présente un comportement étrange lors de
#    la pause. La valeur par défaut est 0.5 secondes.
switch_pin: PA5
#    La broche sur laquelle l'interrupteur est connecté.
#    Ce paramètre doit être fourni.

####################################################################
# INPUT SHAPER
####################################################################

[input_shaper]
#shaper_type_x = ei
#shaper_freq_x = 43.8
#shaper_type_y = mzv
#shaper_freq_y = 45.8

####################################################################
# PINS BEEPER - LED
####################################################################

[output_pin BEEPER_PIN]
pin: PB15
pwm: True
value: 0
shutdown_value: 0
cycle_time: 0.001
scale: 1

#-----------------------------------------------------------------#

[output_pin LED]
pin: mcu:PA13
pwm: False
value: 0

####################################################################
# AUTRES
####################################################################

[temperature_sensor Orange_pi]
sensor_type: temperature_host
#-----------------------------------------------------------------#
[temperature_sensor Mainboard]
sensor_type: temperature_mcu
#-----------------------------------------------------------------#
[gcode_arcs]
resolution: 1.0
#-----------------------------------------------------------------#
[pause_resume]
#-----------------------------------------------------------------#
[display_status]
#-----------------------------------------------------------------#
[respond]
#-----------------------------------------------------------------#
[exclude_object]
#-----------------------------------------------------------------#
[gcode_arcs]
resolution: 1.0

####################################################################

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 32.723
#*# pid_ki = 2.371
#*# pid_kd = 112.893
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 66.236
#*# pid_ki = 0.901
#*# pid_kd = 1217.087
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  -1.957500, -1.950000, -1.883750, -1.857500, -1.843750, -1.862500, -1.937500
#*# 	  -1.950000, -1.880000, -1.862500, -1.820000, -1.822500, -1.850000, -1.975000
#*# 	  -1.915000, -1.868750, -1.867500, -1.841250, -1.856250, -1.860000, -1.980000
#*# 	  -1.953750, -1.900000, -1.846250, -1.843750, -1.855000, -1.916250, -2.031250
#*# 	  -1.998750, -1.941250, -1.880000, -1.855000, -1.903750, -1.941250, -2.070000
#*# 	  -2.028750, -1.915000, -1.890000, -1.886250, -1.921250, -1.978750, -2.127500
#*# 	  -2.107500, -2.036250, -1.970000, -1.956250, -1.960000, -2.008750, -2.215000
#*# x_count = 7
#*# y_count = 7
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 10.0
#*# max_x = 235.0
#*# min_y = 10.0
#*# max_y = 235.0
#*#
#*# [probe]
#*# z_offset = -0.100
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 70.8
#*# shaper_type_y = 2hump_ei
#*# shaper_freq_y = 46.6
